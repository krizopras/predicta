<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Predicta Europe ML v2</title>
<style>
body {
  background: #0f172a; color: #e2e8f0; font-family: "Segoe UI", sans-serif;
  display: flex; flex-direction: column; align-items: center; padding: 30px;
}
h1 { color: #38bdf8; margin-bottom: 20px; }
button {
  background: #2563eb; color: white; border: none; border-radius: 8px;
  padding: 10px 20px; cursor: pointer; margin-top: 15px;
}
button:hover { background: #1d4ed8; }
table {
  border-collapse: collapse; width: 90%; margin-top: 30px; background: #1e293b;
}
th, td { padding: 10px; text-align: center; border-bottom: 1px solid #334155; }
th { background: #0ea5e9; color: #fff; }
</style>
</head>
<body>
<h1>âš½ Predicta Europe ML v2</h1>
<p>Real-time Nesine Bulletin & AI Predictions</p>

<button id="fetchBtn">ðŸ“¡ Fetch Todayâ€™s Bulletin</button>
<button id="predictBtn">ðŸ¤– Predict Matches</button>

<table id="matches">
<thead>
  <tr><th>League</th><th>Home</th><th>Away</th><th>1</th><th>X</th><th>2</th><th>Prediction</th></tr>
</thead>
<tbody></tbody>
</table>

<script>
const API_BASE = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
  ? "http://localhost:8000"
  : "https://predicta-production.up.railway.app";

async function loadMatches() {
  const res = await fetch(`${API_BASE}/api/matches/today`);
  const data = await res.json();
  const tbody = document.querySelector("#matches tbody");
  tbody.innerHTML = "";
  data.items.forEach(m => {
    const row = `<tr>
      <td>${m.league}</td><td>${m.home_team}</td><td>${m.away_team}</td>
      <td>${m.odds?.["1"] || '-'}</td><td>${m.odds?.["X"] || '-'}</td><td>${m.odds?.["2"] || '-'}</td>
      <td>-</td>
    </tr>`;
    tbody.innerHTML += row;
  });
}

async function predictMatches() {
  const res = await fetch(`${API_BASE}/api/predict/today`);
  const data = await res.json();
  const tbody = document.querySelector("#matches tbody");
  tbody.innerHTML = "";
  data.items.forEach(m => {
    const pred = m.prediction?.prediction || "N/A";
    const conf = (m.prediction?.confidence * 100 || 0).toFixed(1);
    const row = `<tr>
      <td>${m.league}</td><td>${m.home_team}</td><td>${m.away_team}</td>
      <td>${m.odds?.["1"] || '-'}</td><td>${m.odds?.["X"] || '-'}</td><td>${m.odds?.["2"] || '-'}</td>
      <td>${pred} (${conf}%)</td>
    </tr>`;
    tbody.innerHTML += row;
  });
}

document.getElementById("fetchBtn").addEventListener("click", loadMatches);
document.getElementById("predictBtn").addEventListener("click", predictMatches);
</script>
</body>
</html>
